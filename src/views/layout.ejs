<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= typeof title !== 'undefined' ? title + ' - The Progress Formula' : 'The Progress Formula' %></title>
    <link rel="icon" href="/public/content/images/favicon.ico" type="image/x-icon">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/css/grid.css">
    
    <!-- Tailwind Typography Plugin -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    typography: {
                        DEFAULT: {
                            css: {
                                maxWidth: '100%',
                            },
                        },
                    },
                },
            },
            plugins: [
                function({addComponents}) {
                    addComponents({
                        '.prose': {
                            '& p': {
                                marginTop: '1em',
                                marginBottom: '1em',
                            },
                            '& h1, & h2, & h3, & h4': {
                                marginTop: '1.5em',
                                marginBottom: '0.5em',
                                fontWeight: '600',
                            },
                            '& h1': { fontSize: '2em' },
                            '& h2': { fontSize: '1.5em' },
                            '& h3': { fontSize: '1.25em' },
                            '& ul, & ol': {
                                paddingLeft: '1.5em',
                                marginTop: '1em',
                                marginBottom: '1em',
                            },
                            '& li': {
                                marginTop: '0.5em',
                                marginBottom: '0.5em',
                            },
                            '& blockquote': {
                                borderLeftWidth: '4px',
                                borderLeftColor: '#e5e7eb',
                                paddingLeft: '1em',
                                fontStyle: 'italic',
                            },
                        },
                    });
                },
            ],
        }
    </script>

    <!-- Custom Styles -->
    <style>
        html {
            scroll-behavior: smooth;
        }

        *:focus {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
        }

        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #666;
        }

        .fixed-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        body {
            padding-top: 64px;
        }
    </style>

    <!-- Ionicons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Navigation -->
    <nav class="fixed-nav">
        <div class="max-w-7xl mx-auto px-2 sm:px-2 lg:px-4">
            <div class="flex justify-between h-16">
                <div class="flex">
                    <!--Logo -->
                    <div class="flex-shrink-0 flex items-center p-[1px]">
                        <a href="/" class="nav-logo">
                            <img src="/public/content/images/tpf_square.png" alt="The Progress Formula Logo" class="h-[62px] w-[62px]">
                        </a>
                    </div>
                    
                    <!-- Navigation Links -->
                    <div class="hidden sm:ml-6 sm:flex sm:gap-4">
                        <a href="/" class="inline-flex items-center px-1 pt-1 text-gray-900 hover:text-blue-600">Home</a>
                        <% if (typeof user !== 'undefined' && user) { %>
                            <a href="/dashboard" class="inline-flex items-center px-1 pt-1 text-gray-900 hover:text-blue-600">Dashboard</a>
                        <% } %>
                    </div>
                </div>

                <!-- Center title -->
                <div class="flex-1 flex justify-center items-center" style="margin-left: -60px;">
                    <h1 class="header-title">The Progress Formula</h1>
                </div>

                <!-- Right side -->
                <div class="flex items-center">
                    <% if (typeof user !== 'undefined' && user) { %>
                        <div class="relative ml-3">
                            <div class="flex items-center space-x-4">
                                <!-- Username with link to profile -->
                                <a href="/profile" class="text-gray-700 hover:text-blue-600 font-medium flex items-center group">
                                    <div class="w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-2 group-hover:bg-blue-600">
                                        <%= user.username.charAt(0).toUpperCase() %>
                                    </div>
                                    <span><%= user.username %></span>
                                </a>
                                <a href="/auth/logout" class="text-red-600 hover:text-red-800">
                                    Logout
                                </a>
                            </div>
                        </div>
                    <% } else { %>
                        <a href="/auth/google" class="flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700">
                            Sign in with Google
                        </a>
                    <% } %>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="py-1 px-4 sm:px-4 lg:px-4">
        <%- typeof body !== 'undefined' ? body : '' %>
    </main>

    <!-- Footer -->
    <footer class="bg-white shadow mt-auto">
        <div class="max-w-7xl mx-auto py-2 px-4 sm:px-6 lg:px-8">
            <p class="text-center text-gray-500 text-sm">
                The Progress Formula &copy; <%= new Date().getFullYear() %>
            </p>
        </div>
    </footer>
</body>
</html>